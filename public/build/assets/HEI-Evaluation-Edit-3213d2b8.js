import{k as ge,l as be,m as s,E as xe,s as ye,A as v,o as d,f as u,a as n,b as e,w as r,t as f,i as g,p as I,F as T,d as k,g as te,C as oe,n as w,B as O,D as we,O as E}from"./app-612f8f79.js";import"./index-decdce8d.js";import ke from"./Layout-688c6e41.js";const Se={class:"md:mx-8 mx-3 mt-8 flex flex-col lg:flex-row justify-between rounded relative"},Ee=e("button",{class:"w-24 h-10 border border-gray-500 rounded bg-white"},[e("i",{class:"fas fa-arrow-left mr-2"}),k(" Back ")],-1),Ce={class:"flex flex-wrap mt-3 lg:mt-0"},Le={class:"flex-col lg:mt-0 mt-2 text-center mx-1 p-2 px-4 rounded border border-gray-500 bg-white"},Fe={class:"w-full font-bold text-blue-500"},Ie=e("div",{class:"font-bold text-gray-700 text-sm"},"Complied",-1),Ne={class:"flex-col lg:mt-0 mt-2 text-center mx-1 p-2 px-4 rounded border border-gray-500 bg-white"},$e={class:"w-full font-bold text-blue-500"},Me=e("div",{class:"font-bold text-gray-700 text-sm"},"Not Complied",-1),Ve={class:"flex-col lg:mt-0 mt-2 text-center mx-1 p-2 px-4 rounded border border-gray-500 bg-white"},Ue={class:"w-full font-bold text-blue-500"},Be=e("div",{class:"font-bold text-gray-700 text-sm"},"Not Applicable",-1),Ae={class:"flex-col lg:mt-0 mt-2 text-center mx-1 p-2 px-4 rounded border border-gray-500 bg-white"},De={class:"w-full font-bold text-blue-500"},He=e("div",{class:"font-bold text-gray-700 text-sm"},"Progress",-1),Re={class:"flex flex-col w-auto rounded border border-gray-400 bg-white mx-3 md:mx-8 mt-5 p-3"},Te={class:"w-auto flex flex-col md:flex-row"},Oe=e("div",{class:"mr-2 font-bold tracking-tight"}," HEI Name: ",-1),je={class:"tracking-tight"},ze={class:"w-auto flex flex-col md:flex-row mt-2 md:mt-1"},Ke={class:"w-auto flex flex-col md:flex-row"},Pe=e("div",{class:"mr-2 font-bold tracking-tight"}," Program: ",-1),qe={class:"tracking-tight"},Ye={class:"w-auto flex flex-col md:flex-row mt-2 md:mt-1"},We={class:"w-auto flex flex-col md:flex-row"},Ge=e("div",{class:"mr-2 font-bold tracking-tight"}," Effectivity: ",-1),Je={class:"tracking-tight"},Qe={class:"whitespace-normal mr-2"},Xe={class:"whitespace-normal"},Ze={key:0,class:"text-red-500"},et={key:1},tt=e("i",{class:"fas fa-check-circle text-green-500 mr-1"},null,-1),ot=e("th",{class:"p-3 max-w-xs"},"Area",-1),st=e("th",{class:"p-3 max-w-xs"},"Minimum Requirement",-1),at=e("th",{class:"p-3 w-16"},"Actual Situation",-1),lt=e("th",{class:"p-3 w-16"},"Evidence",-1),nt=e("th",{class:"p-3 whitespace-normal"},"Self-Evaluation Status",-1),it=e("th",{class:"p-3 text-right"},[e("i",{class:"fas fa-ellipsis-v"})],-1),dt={class:"p-3 whitespace-normal max-w-10"},ut={class:"flex flex-col"},rt={class:"font-bold"},ct={class:"p-3 whitespace-normal max-w-xs"},pt={class:"flex flex-col text-justify"},ht={class:"h-32 max-w-lg p-3 relative group"},vt=["onUpdate:modelValue","name","id","disabled","onInput"],ft=["onClick"],_t=e("i",{class:"fas fa-pen"},null,-1),mt=[_t],gt=["onUpdate:modelValue","name","id","onFocus","onInput"],bt={class:"h-auto p-3 w-16 flex flex-col justify-center"},xt=["href"],yt={key:0},wt={key:1},kt=["onClick","disabled","data-tooltip"],St=e("i",{class:"fas fa-trash"},null,-1),Et=[St],Ct={class:"h-32 p-3"},Lt={class:"w-full h-full"},Ft=["onUpdate:modelValue","id","name","onChange"],It=e("option",{value:null},"Select status",-1),Nt=e("option",{value:"Complied"},"Complied",-1),$t=e("option",{value:"Not complied"},"Not complied",-1),Mt=e("option",{value:"Not applicable"},"Not applicable",-1),Vt=[It,Nt,$t,Mt],Ut={class:"p-3"},Bt=["onClick","disabled"],At=e("i",{class:"fas fa-upload mr-2"},null,-1),Dt=["onClick","disabled"],Ht=e("i",{class:"fas fa-upload mr-2"},null,-1),Rt={class:"text-center"},Tt=["disabled"],Ot={key:0},jt=e("i",{class:"fas fa-spinner animate-spin"},null,-1),zt=[jt],Kt={key:1},Pt=["disabled"],qt={key:0},Yt=e("i",{class:"fas fa-spinner animate-spin"},null,-1),Wt=[Yt],Gt={key:1},Jt={layout:ke,data(){return{itemsLayout:"list"}},methods:{listLayout(){this.itemsLayout="list"},gridLayout(){this.itemsLayout="grid"}}},oo=Object.assign(Jt,{__name:"HEI-Evaluation-Edit",props:["evaluation","items","progress","canSubmit"],setup(_){const S=_,j=t=>{c.value&&(t.returnValue=!0)};ge(()=>{window.addEventListener("keydown",ee),window.addEventListener("beforeunload",j)}),be(()=>{window.removeEventListener("keydown",ee),window.removeEventListener("beforeunload",j)});const N=s(!1),C=s(!1),z=s(null),$=s(!1),L=s(!1),K=s(null),F=s(null),se=s(!1),M=s(!1),P=s(null),V=s(null),q=s([]),U=s(!1),Y=s(""),W=s([]),B=s(!1),A=s([]),G=s([]),J=s([]),Q=s([]),c=s(!1),D=s([]),X=s(null),H=s(!1),x={actualSituationInput:A,selfEvaluationStatus:G,actionButtons:J,evidenceFiles:Q,saveBtn:X,texteditor:W,inputEvidenceFile:q};function ae(t,l){let p=A.value[t];p.style.height="128px";let m=p.scrollHeight+"px",h=384;p.style.height=Math.min(h,Math.max(128,parseInt(m)))+"px",c.value=!0,R(l)}function Z(t,l){let p=x.texteditor.value[t];p.style.height="250px";let m=p.scrollHeight+"px",h=400;p.style.height=Math.min(h,Math.max(128,parseInt(m)))+"px",c.value=!0,R(l)}function le(t,l){let p=x.selfEvaluationStatus.value[t],m=x.actualSituationInput.value[t],h=x.actionButtons.value[t],y=x.evidenceFiles.value[t];c.value=!0,R(l),p.value=="Not applicable"?(m.disabled=!0,h.classList.contains("hidden")||h.classList.add("hidden"),y.classList.contains("hidden")||y.classList.add("hidden")):(m.disabled=!1,h.classList.contains("hidden")&&h.classList.remove("hidden"),y.classList.contains("hidden")&&y.classList.remove("hidden"))}function R(t){D.value.includes(t)||D.value.push(t)}function ne(t){U.value=!0,Y.value=t}function ie(){U.value=!1}function de(){B.value=!1}const ee=t=>{(t.ctrlKey||t.metaKey)&&(t.key==="s"||t.key==="S")&&(t.preventDefault(),x.saveBtn.value.click())};xe({itemId:null,file:null});function ue(){E.post("/hei/evaluation/update",{id:S.evaluation.id,items:S.items,rows:D.value},{onStart:()=>{H.value=!0},onFinish:()=>{H.value=!1},preserveScroll:!0,preserveState:!1})}function re(){E.post("/hei/evaluation/link",{id:K.value,link:F.value},{onStart:()=>{L.value=!0},onFinish:()=>{L.value=!1},preserveState:!1,preserveScroll:!0})}function ce(){E.post("/hei/evaluation/link/delete",{id:S.evaluation.id,item:z.value},{onStart:()=>{C.value=!0},onFinish:()=>{C.value=!1},preserveState:!1,preserveScroll:!0})}function pe(){E.post("/hei/evaluation/submit",S.evaluation)}return ye(V,t=>{E.post("/hei/evaluation/upload",{id:S.evaluation.id,itemId:P.value,file:V.value},{onStart:()=>{M.value=!0},onFinish:()=>{M.value=!1},preserveState:!1,preserveScroll:!0})}),(t,l)=>{const p=v("Head"),m=v("page-title"),h=v("Link"),y=v("text-editor"),he=v("content-table"),ve=v("content-container"),fe=v("confirmation"),_e=v("modal"),me=v("confirmation-modal"),b=v("Notification");return d(),u(T,null,[n(p,{title:"Evaluation Form"}),n(m,{title:"Program Self-Evaluation"}),e("div",Se,[e("div",null,[n(h,{href:"/hei/evaluation"},{default:r(()=>[Ee]),_:1})]),e("div",Ce,[e("div",Le,[e("div",Fe,f(_.progress[0]),1),Ie]),e("div",Ne,[e("div",$e,f(_.progress[1]),1),Me]),e("div",Ve,[e("div",Ue,f(_.progress[2]),1),Be]),e("div",Ae,[e("div",De,f(_.progress[3])+"%",1),He])])]),e("div",Re,[e("div",Te,[Oe,e("div",je,f(_.evaluation.institution_program.institution.name),1)]),e("div",ze,[e("div",Ke,[Pe,e("div",qe,f(_.evaluation.institution_program.program.program),1)])]),e("div",Ye,[e("div",We,[Ge,e("div",Je," A.Y. "+f(_.evaluation.effectivity),1)])])]),n(ve,{hasTopButton:!0},{"top-button":r(()=>[e("div",Qe,[e("button",{onClick:ue,ref_key:"saveBtn",ref:X,class:"select-none cursor-pointer bg-blue-500 hover:bg-blue-600 mr-2 text-white px-2 w-fit h-10 rounded"},"Save Changes ",512),e("button",{onClick:l[0]||(l[0]=o=>B.value=!0),class:"px-3 w-fit text-white bg-green-600 hover:bg-green-700 h-10 rounded mr-1"}," Ready for visit ")]),e("div",Xe,[c.value?(d(),u("div",Ze," *Changes unsaved. ")):t.$page.props.flash.updated?(d(),u("div",et,[tt,k(" "+f(t.$page.props.flash.updated),1)])):te("",!0)])]),"main-content":r(()=>[g(n(he,null,{"table-head":r(()=>[ot,st,at,lt,nt,it]),"table-body":r(()=>[(d(!0),u(T,null,oe(_.items,(o,i)=>(d(),u("tr",{key:o.id,class:w(["align-top text-base",{"bg-slate-200":i%2==0}])},[e("td",dt,[e("div",ut,[e("div",rt,f(o.area),1)])]),e("td",ct,[e("div",pt,f(o.minimumRequirement),1)]),e("td",ht,[g(e("textarea",{ref_for:!0,ref_key:"actualSituationInput",ref:A,"onUpdate:modelValue":a=>o.actualSituation=a,name:"actualSituation"+i,id:"actualSituation"+i,class:"w-full min-w-16 h-32 rounded border-2 border-gray-500 resize-none group custom-scrollbar",disabled:o.selfEvaluationStatus=="Not applicable",placeholder:"Input actual situation here",onInput:a=>ae(i,o.id)},`\r
                            `,40,vt),[[O,o.actualSituation]]),e("button",{onClick:a=>ne(i),class:"absolute bottom-4 right-10 text-gray-500 hover:text-black group-focus-within:visible invisible tooltipForActions","data-tooltip":"Open editor"},mt,8,ft),n(y,{title:"Actual Situation",showModal:U.value&&Y.value==i,onClose:ie},{default:r(()=>[g(e("textarea",{ref_for:!0,ref_key:"texteditor",ref:W,"onUpdate:modelValue":a=>o.actualSituation=a,name:"actualSituationEditor"+i,id:"actualSituationEditor"+i,class:"w-full h-32 rounded border-2 border-gray-500 resize-none group",placeholder:"Input actual situation here",onFocus:a=>Z(i),onInput:a=>Z(i,o.id)},`\r
                            `,40,gt),[[O,o.actualSituation]])]),_:2},1032,["showModal"])]),e("td",bt,[e("div",{class:w(["flex flex-col",{hidden:o.selfEvaluationStatus=="Not applicable"}]),ref_for:!0,ref_key:"evidenceFiles",ref:Q},[(d(!0),u(T,null,oe(o.evidence,(a,Qt)=>(d(),u("div",{key:a.id,class:"w-full"},[e("a",{class:"px-1 text-gray-600 hover:text-blue-500 m-1 rounded",href:a.url,target:"_blank"},[a.type=="file"?(d(),u("span",yt," File ")):a.type=="link"?(d(),u("span",wt," Link ")):te("",!0)],8,xt),e("button",{onClick:Xt=>{N.value=!0,z.value=a.id},class:w(["text-gray-500 hover:text-red-500 tooltipForActions",{"grayscale text-gray-500":c.value}]),disabled:o.selfEvaluationStatus=="Not applicable"||c.value,"data-tooltip":a.type=="file"?"Delete file":"Delete link"},Et,10,kt)]))),128))],2)]),e("td",Ct,[e("div",Lt,[g(e("select",{ref_for:!0,ref_key:"selfEvaluationStatus",ref:G,"onUpdate:modelValue":a=>o.selfEvaluationStatus=a,id:"selfEvaluationStatus"+i,name:"selfEvaluationStatus"+i,onChange:a=>le(i,o.id),class:"p-1 rounded w-36 border-2 border-gray-500 select-none"},Vt,40,Ft),[[we,o.selfEvaluationStatus]])])]),e("td",Ut,[e("div",{class:w(["w-full text-right text-sm visible",{invisible:o.selfEvaluationStatus=="Not applicable"}]),ref_for:!0,ref_key:"actionButtons",ref:J},[e("button",{onClick:a=>{se.value=!0,P.value=o.id,t.$refs.inputEvidenceFile.click()},class:w(["rounded bg-white h-8 mr-1 px-2 text-gray-700 hover:text-black active:text-blue-500 border-2 border-gray-500 tooltipForActions",{"grayscale text-gray-400":c.value}]),"data-tooltip":"Upload file",disabled:o.selfEvaluationStatus=="Not applicable"||c.value},[At,k("File ")],10,Bt),e("button",{onClick:a=>{$.value=!0,F.value=null,K.value=o.id},class:w(["rounded bg-white h-8 px-2 text-gray-700 hover:text-black active:text-blue-500 border-2 border-gray-500 tooltipForActions",{"grayscale text-gray-400":c.value}]),"data-tooltip":"Drop link",disabled:o.selfEvaluationStatus=="Not applicable"||c.value},[Ht,k("Link ")],10,Dt)],2)])],2))),128))]),_:1},512),[[I,t.itemsLayout==="list"]])]),_:1}),g(n(fe,{onClose:de,title:"Ready For Visit"},{message:r(()=>[k(" Are you sure you want to submit this compliance evaluation tool? You won't be able to make changes after submitting. ")]),buttons:r(()=>[e("button",{class:"text-gray-100 bg-blue-500 hover:text-white hover:bg-blue-600 p-2 px-3 rounded mr-1",onClick:pe}," Submit ")]),_:1},512),[[I,B.value]]),e("div",null,[e("input",{type:"file",hidden:"",ref_key:"inputEvidenceFile",ref:q,id:"inputEvidenceFile",onChange:l[1]||(l[1]=o=>V.value=o.target.files[0])},null,544)]),n(_e,{showModal:$.value,title:"Evidence Link",onClose:l[3]||(l[3]=o=>$.value=!1)},{"custom-button":r(()=>[e("button",{onClick:re,disabled:L.value,class:"text-white bg-blue-600 hover:bg-blue-700 w-24 py-2 px-3 rounded border"},[L.value?(d(),u("span",Ot,zt)):(d(),u("span",Kt,"Upload"))],8,Tt)]),default:r(()=>[e("div",Rt,[g(e("textarea",{class:"w-full h-32 resize-none",placeholder:"Input URL/Link here",id:"link","onUpdate:modelValue":l[2]||(l[2]=o=>F.value=o)},`\r
            `,512),[[O,F.value]])])]),_:1},8,["showModal"]),n(me,{showModal:N.value,onClose:l[4]||(l[4]=o=>N.value=!1),title:"Delete file/link"},{message:r(()=>[k(" Are you sure you want to delete this evidence file/link? This action can't be undone. ")]),buttons:r(()=>[e("button",{onClick:ce,disabled:C.value,class:"select-none text-white h-10 w-20 rounded bg-red-500"},[C.value?(d(),u("span",qt,Wt)):(d(),u("span",Gt,"Delete"))],8,Pt)]),_:1},8,["showModal"]),n(b,{message:t.$page.props.flash.success,type:"success"},null,8,["message"]),n(b,{message:t.$page.props.flash.updated,type:"success"},null,8,["message"]),n(b,{message:t.$page.props.flash.deleted,type:"success"},null,8,["message"]),n(b,{message:t.$page.props.flash.uploaded,type:"success"},null,8,["message"]),n(b,{message:t.$page.props.errors.link,type:"failed"},null,8,["message"]),g(n(b,{message:"Saving...",type:"processing"},null,512),[[I,H.value]]),g(n(b,{message:"Uploading file...",type:"processing"},null,512),[[I,M.value]])],64)}}});export{oo as default};
