import{k as be,l as ge,m as o,E as we,s as xe,A as h,o as d,f as r,a,b as e,w as c,t as v,d as w,i as g,p as I,F as T,g as te,C as se,n as k,B as j,D as ye,O as E}from"./app-ee162bce.js";import"./index-f52ffc17.js";import ke from"./Layout-a469915b.js";const Se={class:"md:mx-8 mx-3 mt-8 flex flex-row justify-between rounded relative"},Ee=e("button",{class:"select-none w-24 h-10 border border-gray-500 rounded bg-white"},[e("i",{class:"fas fa-arrow-left mr-2"}),w(" Back ")],-1),Ce={class:"flex flex-col xl:flex-row items-center justify-between w-auto rounded border border-gray-400 bg-white mx-3 md:mx-8 mt-5 p-3"},Le={class:"w-full text-left"},Fe={class:"w-auto flex flex-row items-center"},Ie=e("i",{class:"fas fa-institution mr-3 text-blue-500"},null,-1),$e={class:"w-auto flex flex-row items-center"},Ne=e("i",{class:"fas fa-book mr-3 text-blue-500"},null,-1),Me=e("span",null,null,-1),Ve={class:"w-auto flex flex-row items-center"},Ue=e("i",{class:"fas fa-calendar-check mr-3 text-blue-500"},null,-1),Be={class:"xl:w-auto w-full text-right mt-5 xl:mt-0"},Ae={class:"flex flex-col md:flex-row lg:mt-0 md:w-auto w-full"},De={class:"flex-col xl:mt-0 mt-2 text-center mx-1 p-2 px-3 md:w-fit w-full rounded border border-gray-500 bg-white"},He={class:"w-full font-bold"},Re=e("div",{class:"font-bold text-blue-500 whitespace-nowrap text-sm"},"Complied",-1),Te={class:"flex-col xl:mt-0 mt-2 text-center mx-1 p-2 px-3 md:w-fit w-full rounded border border-gray-500 bg-white"},je={class:"w-full font-bold"},Oe=e("div",{class:"font-bold text-blue-500 whitespace-nowrap text-sm"},"Not Complied",-1),ze={class:"flex-col xl:mt-0 mt-2 text-center mx-1 p-2 px-3 md:w-fit w-full rounded border border-gray-500 bg-white"},Ke={class:"w-full font-bold"},Pe=e("div",{class:"font-bold text-blue-500 whitespace-nowrap text-sm"},"Not Applicable",-1),qe={class:"flex-col xl:mt-0 mt-2 text-center mx-1 p-2 px-3 md:w-fit w-full rounded border border-gray-500 bg-white"},Ye={class:"w-full font-bold"},We=e("div",{class:"font-bold text-blue-500 whitespace-nowrap text-sm"},"Progress",-1),Ge={class:"whitespace-normal mr-2"},Je={class:"whitespace-normal"},Qe={key:0,class:"text-red-500"},Xe={key:1},Ze=e("i",{class:"fas fa-check-circle text-green-500 mr-1"},null,-1),et=e("th",{class:"p-3 max-w-xs"},"Area",-1),tt=e("th",{class:"p-3 max-w-xs"},"Minimum Requirement",-1),st=e("th",{class:"p-3 w-16"},"Actual Situation",-1),ot=e("th",{class:"p-3 w-16"},"Evidence",-1),lt=e("th",{class:"p-3 whitespace-normal"},"Self-Evaluation Status",-1),at=e("th",{class:"p-3 text-right"},[e("i",{class:"fas fa-ellipsis-v"})],-1),nt={class:"p-3 whitespace-normal max-w-10"},it={class:"flex flex-col"},ut={class:"font-bold"},dt={class:"p-3 whitespace-normal max-w-xs"},rt={class:"flex flex-col text-justify"},ct={class:"h-32 max-w-lg p-3 relative group"},pt=["onUpdate:modelValue","name","id","disabled","onInput"],ft=["onClick"],ht=e("i",{class:"fas fa-pen"},null,-1),vt=[ht],_t=["onUpdate:modelValue","name","id","onFocus","onInput"],mt={class:"h-auto p-3 w-16 flex flex-col justify-center"},bt=["href"],gt={key:0},wt={key:1},xt=["onClick","disabled","data-tooltip"],yt=e("i",{class:"fas fa-trash"},null,-1),kt=[yt],St={class:"h-32 p-3"},Et={class:"w-full h-full"},Ct=["onUpdate:modelValue","id","name","onChange"],Lt=e("option",{value:null},"Select status",-1),Ft=e("option",{value:"Complied"},"Complied",-1),It=e("option",{value:"Not complied"},"Not complied",-1),$t=e("option",{value:"Not applicable"},"Not applicable",-1),Nt=[Lt,Ft,It,$t],Mt={class:"p-3"},Vt=["onClick","disabled"],Ut=e("i",{class:"fas fa-upload mr-2"},null,-1),Bt=["onClick","disabled"],At=e("i",{class:"fas fa-upload mr-2"},null,-1),Dt={class:"text-center"},Ht=["disabled"],Rt={key:0},Tt=e("i",{class:"fas fa-spinner animate-spin"},null,-1),jt=[Tt],Ot={key:1},zt=["disabled"],Kt={key:0},Pt=e("i",{class:"fas fa-spinner animate-spin"},null,-1),qt=[Pt],Yt={key:1},Wt={layout:ke,data(){return{itemsLayout:"list"}},methods:{listLayout(){this.itemsLayout="list"},gridLayout(){this.itemsLayout="grid"}}},Zt=Object.assign(Wt,{__name:"HEI-Evaluation-Edit",props:["evaluation","items","progress","canSubmit"],setup(_){const S=_,O=t=>{i.value&&(t.returnValue=!0)};be(()=>{window.addEventListener("keydown",ee),window.addEventListener("beforeunload",O)}),ge(()=>{window.removeEventListener("keydown",ee),window.removeEventListener("beforeunload",O)});const $=o(!1),C=o(!1),z=o(null),N=o(!1),L=o(!1),K=o(null),F=o(null),oe=o(!1),M=o(!1),P=o(null),V=o(null),q=o([]),U=o(!1),Y=o(""),W=o([]),B=o(!1),A=o([]),G=o([]),J=o([]),Q=o([]),i=o(!1),D=o([]),X=o(null),H=o(!1),x={actualSituationInput:A,selfEvaluationStatus:G,actionButtons:J,evidenceFiles:Q,saveBtn:X,texteditor:W,inputEvidenceFile:q};function le(t,n){let p=A.value[t];p.style.height="128px";let m=p.scrollHeight+"px",f=384;p.style.height=Math.min(f,Math.max(128,parseInt(m)))+"px",i.value=!0,R(n)}function Z(t,n){let p=x.texteditor.value[t];p.style.height="250px";let m=p.scrollHeight+"px",f=400;p.style.height=Math.min(f,Math.max(128,parseInt(m)))+"px",i.value=!0,R(n)}function ae(t,n){let p=x.selfEvaluationStatus.value[t],m=x.actualSituationInput.value[t],f=x.actionButtons.value[t],y=x.evidenceFiles.value[t];i.value=!0,R(n),p.value=="Not applicable"?(m.disabled=!0,f.classList.contains("hidden")||f.classList.add("hidden"),y.classList.contains("hidden")||y.classList.add("hidden")):(m.disabled=!1,f.classList.contains("hidden")&&f.classList.remove("hidden"),y.classList.contains("hidden")&&y.classList.remove("hidden"))}function R(t){D.value.includes(t)||D.value.push(t)}function ne(t){U.value=!0,Y.value=t}function ie(){U.value=!1}function ue(){B.value=!1}const ee=t=>{(t.ctrlKey||t.metaKey)&&(t.key==="s"||t.key==="S")&&(t.preventDefault(),x.saveBtn.value.click())};we({itemId:null,file:null});function de(){E.post("/hei/evaluation/update",{id:S.evaluation.id,items:S.items,rows:D.value},{onStart:()=>{H.value=!0},onFinish:()=>{H.value=!1},preserveScroll:!0,preserveState:!1})}function re(){E.post("/hei/evaluation/link",{id:K.value,link:F.value},{onStart:()=>{L.value=!0},onFinish:()=>{L.value=!1},preserveState:!1,preserveScroll:!0})}function ce(){E.post("/hei/evaluation/link/delete",{id:S.evaluation.id,item:z.value},{onStart:()=>{C.value=!0},onFinish:()=>{C.value=!1},preserveState:!1,preserveScroll:!0})}function pe(){E.post("/hei/evaluation/submit",S.evaluation)}return xe(V,t=>{E.post("/hei/evaluation/upload",{id:S.evaluation.id,itemId:P.value,file:V.value},{onStart:()=>{M.value=!0},onFinish:()=>{M.value=!1},preserveState:!1,preserveScroll:!0})}),(t,n)=>{const p=h("Head"),m=h("page-title"),f=h("Link"),y=h("text-editor"),fe=h("content-table"),he=h("content-container"),ve=h("confirmation"),_e=h("modal"),me=h("confirmation-modal"),b=h("Notification");return d(),r(T,null,[a(p,{title:"Program Self-Evaluation Tool"}),a(m,{title:"Program Self-Evaluation"}),e("div",Se,[e("div",null,[a(f,{href:"/evaluation"},{default:c(()=>[Ee]),_:1})]),e("div",null,[e("button",{onClick:n[0]||(n[0]=s=>B.value=!0),class:"select-none px-3 w-fit text-white bg-gray-600 hover:bg-gray-700 h-10 rounded mr-1"}," Ready for visit ")])]),e("div",Ce,[e("div",Le,[e("div",Fe,[Ie,e("div",null,v(_.evaluation.institution_program.institution.name),1)]),e("div",$e,[Ne,e("div",null,[w(v(_.evaluation.institution_program.program.program)+" ",1),Me])]),e("div",Ve,[Ue,e("div",null,"A.Y. "+v(_.evaluation.effectivity),1)])]),e("div",Be,[e("div",Ae,[e("div",De,[e("div",He,v(_.progress[0]),1),Re]),e("div",Te,[e("div",je,v(_.progress[1]),1),Oe]),e("div",ze,[e("div",Ke,v(_.progress[2]),1),Pe]),e("div",qe,[e("div",Ye,v(_.progress[3])+"%",1),We])])])]),a(he,{hasTopButton:!0},{"top-button":c(()=>[e("div",Ge,[e("button",{onClick:de,ref_key:"saveBtn",ref:X,class:"select-none cursor-pointer bg-blue-500 hover:bg-blue-600 mr-2 text-white px-2 w-fit h-10 rounded"},"Save Changes ",512)]),e("div",Je,[i.value?(d(),r("div",Qe," *Changes unsaved. ")):t.$page.props.flash.updated?(d(),r("div",Xe,[Ze,w(" "+v(t.$page.props.flash.updated),1)])):te("",!0)])]),"main-content":c(()=>[g(a(fe,null,{"table-head":c(()=>[et,tt,st,ot,lt,at]),"table-body":c(()=>[(d(!0),r(T,null,se(_.items,(s,u)=>(d(),r("tr",{key:s.id,class:k(["align-top text-base",{"bg-slate-200":u%2==0}])},[e("td",nt,[e("div",it,[e("div",ut,v(s.area),1)])]),e("td",dt,[e("div",rt,v(s.minimumRequirement),1)]),e("td",ct,[g(e("textarea",{ref_for:!0,ref_key:"actualSituationInput",ref:A,"onUpdate:modelValue":l=>s.actualSituation=l,name:"actualSituation"+u,id:"actualSituation"+u,class:"w-full min-w-16 h-32 rounded border-2 border-gray-500 resize-none group custom-scrollbar",disabled:s.selfEvaluationStatus=="Not applicable",placeholder:"Input actual situation here",onInput:l=>le(u,s.id)},`\r
                            `,40,pt),[[j,s.actualSituation]]),e("button",{onClick:l=>ne(u),class:"absolute bottom-4 right-10 text-gray-500 hover:text-black group-focus-within:visible invisible tooltipForActions","data-tooltip":"Open editor"},vt,8,ft),a(y,{title:"Actual Situation",showModal:U.value&&Y.value==u,onClose:ie},{default:c(()=>[g(e("textarea",{ref_for:!0,ref_key:"texteditor",ref:W,"onUpdate:modelValue":l=>s.actualSituation=l,name:"actualSituationEditor"+u,id:"actualSituationEditor"+u,class:"w-full h-32 rounded border-2 border-gray-500 resize-none group",placeholder:"Input actual situation here",onFocus:l=>Z(u),onInput:l=>Z(u,s.id)},`\r
                            `,40,_t),[[j,s.actualSituation]])]),_:2},1032,["showModal"])]),e("td",mt,[e("div",{class:k(["flex flex-col",{hidden:s.selfEvaluationStatus=="Not applicable"}]),ref_for:!0,ref_key:"evidenceFiles",ref:Q},[(d(!0),r(T,null,se(s.evidence,l=>(d(),r("div",{key:l.id,class:"w-full"},[e("a",{class:"px-1 text-gray-600 hover:text-blue-500 m-1 rounded",href:l.url,target:"_blank"},[l.type=="file"?(d(),r("span",gt," File ")):l.type=="link"?(d(),r("span",wt," Link ")):te("",!0)],8,bt),e("button",{onClick:Gt=>{$.value=!0,z.value=l.id},class:k(["text-gray-500 hover:text-red-500 tooltipForActions",{"grayscale text-gray-500":i.value}]),disabled:s.selfEvaluationStatus=="Not applicable"||i.value,"data-tooltip":l.type=="file"?"Delete file":"Delete link"},kt,10,xt)]))),128))],2)]),e("td",St,[e("div",Et,[g(e("select",{ref_for:!0,ref_key:"selfEvaluationStatus",ref:G,"onUpdate:modelValue":l=>s.selfEvaluationStatus=l,id:"selfEvaluationStatus"+u,name:"selfEvaluationStatus"+u,onChange:l=>ae(u,s.id),class:"p-1 rounded w-36 border-2 border-gray-500 select-none"},Nt,40,Ct),[[ye,s.selfEvaluationStatus]])])]),e("td",Mt,[e("div",{class:k(["w-full text-right text-sm visible",{invisible:s.selfEvaluationStatus=="Not applicable"}]),ref_for:!0,ref_key:"actionButtons",ref:J},[e("button",{onClick:l=>{oe.value=!0,P.value=s.id,t.$refs.inputEvidenceFile.click()},class:k(["rounded bg-white h-8 mr-1 px-2 border-2 tooltipForActions",[{"grayscale text-blue-400 border-gray-400":i.value},{"hover:text-blue-500 border-gray-500":!i.value}]]),"data-tooltip":"Upload file",disabled:s.selfEvaluationStatus=="Not applicable"||i.value},[Ut,w("File ")],10,Vt),e("button",{onClick:l=>{N.value=!0,F.value=null,K.value=s.id},class:k(["rounded bg-white h-8 px-2 border-2 tooltipForActions",[{"grayscale text-blue-400 border-gray-400":i.value},{"hover:text-blue-500 border-gray-500":!i.value}]]),"data-tooltip":"Drop link",disabled:s.selfEvaluationStatus=="Not applicable"||i.value},[At,w("Link ")],10,Bt)],2)])],2))),128))]),_:1},512),[[I,t.itemsLayout==="list"]])]),_:1}),g(a(ve,{onClose:ue,title:"Ready For Visit"},{message:c(()=>[w(" Are you sure you want to submit this compliance evaluation tool? You won't be able to make changes after submitting. ")]),buttons:c(()=>[e("button",{class:"text-gray-100 bg-blue-500 hover:text-white hover:bg-blue-600 p-2 px-3 rounded mr-1",onClick:pe}," Submit ")]),_:1},512),[[I,B.value]]),e("div",null,[e("input",{type:"file",hidden:"",ref_key:"inputEvidenceFile",ref:q,id:"inputEvidenceFile",onChange:n[1]||(n[1]=s=>V.value=s.target.files[0])},null,544)]),a(_e,{showModal:N.value,title:"Evidence Link",onClose:n[3]||(n[3]=s=>N.value=!1)},{"custom-button":c(()=>[e("button",{onClick:re,disabled:L.value,class:"text-white bg-blue-600 hover:bg-blue-700 w-24 py-2 px-3 rounded border"},[L.value?(d(),r("span",Rt,jt)):(d(),r("span",Ot,"Upload"))],8,Ht)]),default:c(()=>[e("div",Dt,[g(e("textarea",{class:"w-full h-32 resize-none",placeholder:"Input URL/Link here",id:"link","onUpdate:modelValue":n[2]||(n[2]=s=>F.value=s)},`\r
            `,512),[[j,F.value]])])]),_:1},8,["showModal"]),a(me,{showModal:$.value,onClose:n[4]||(n[4]=s=>$.value=!1),title:"Delete file/link"},{message:c(()=>[w(" Are you sure you want to delete this evidence file/link? This action can't be undone. ")]),buttons:c(()=>[e("button",{onClick:ce,disabled:C.value,class:"select-none text-white h-10 w-20 rounded bg-red-500"},[C.value?(d(),r("span",Kt,qt)):(d(),r("span",Yt,"Delete"))],8,zt)]),_:1},8,["showModal"]),a(b,{message:t.$page.props.flash.success,type:"success"},null,8,["message"]),a(b,{message:t.$page.props.flash.failed,type:"failed"},null,8,["message"]),a(b,{message:t.$page.props.flash.updated,type:"success"},null,8,["message"]),a(b,{message:t.$page.props.flash.deleted,type:"success"},null,8,["message"]),a(b,{message:t.$page.props.flash.uploaded,type:"success"},null,8,["message"]),a(b,{message:t.$page.props.errors.link,type:"failed"},null,8,["message"]),g(a(b,{message:"Saving...",type:"processing"},null,512),[[I,H.value]]),g(a(b,{message:"Uploading file...",type:"processing"},null,512),[[I,M.value]])],64)}}});export{Zt as default};
