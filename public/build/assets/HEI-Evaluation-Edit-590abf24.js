import{k as me,l as ge,m as o,E as be,s as xe,A as v,o as d,f as u,a as n,b as e,w as p,d as m,t as _,i as g,p as E,n as y,F as j,O as C,C as te,B as z,g as ye,D as we}from"./app-f4d80686.js";import"./index-5fbe21de.js";import ke from"./Layout-713aa5ab.js";const Se={class:"mt-5 md:mx-8 mx-3 flex flex-col md:flex-row justify-between sticky top-0 z-80 p-3 items-center"},Ee=e("button",{class:"w-fit h-10 hover:bg-gray-300 bg-white px-3 border-2 border-gray-500 rounded"},[e("i",{class:"fas fa-arrow-left mr-2"}),m("Back ")],-1),Ce={class:"flex flex-wrap"},Le={class:"h-fit mt-1 flex flex-wrap border border-gray-400 rounded py-2 text-sm bg-white"},Fe={class:"px-3 md:mt-0 mt-2"},Ie=e("br",null,null,-1),Ne={class:"font-bold text-blue-500"},$e={class:"px-3 md:mt-0 mt-2"},Me=e("br",null,null,-1),Ve={class:"font-bold text-blue-500"},Ue={class:"px-3 md:mt-0 mt-2"},Be=e("br",null,null,-1),Ae={class:"font-bold text-blue-500"},De={class:"h-fit m-1 flex flex-wrap border border-gray-400 rounded py-2 text-sm bg-white"},He={class:"px-3 md:mt-0 mt-2"},Re=e("br",null,null,-1),je={class:"font-bold text-blue-500"},ze={class:"flex"},Oe={class:"flex flex-row justify-between"},Te={class:"text-gray-500 h-10 lg:ml-1 flex items-center mr-5"},Ke={key:0,class:"text-red-500"},Pe={key:1},qe=e("i",{class:"fas fa-check-circle text-green-500 mr-1"},null,-1),Ye={key:2},We=["disabled"],Ge={class:"flex flex-col-reverse lg:flex-row justify-between rounded bg-white p-2 align-top"},Je={class:"flex flex-col w-auto rounded md:mt-0 mt-5"},Qe={class:"w-auto flex flex-col md:flex-row"},Xe=e("div",{class:"mr-2 font-bold tracking-tight"}," HEI Name: ",-1),Ze={class:"tracking-tight"},et={class:"w-auto flex flex-col md:flex-row mt-2 md:mt-1"},tt={class:"w-auto flex flex-col md:flex-row"},st=e("div",{class:"mr-2 font-bold tracking-tight"}," Program: ",-1),ot={class:"tracking-tight"},at={class:"w-auto flex flex-col md:flex-row mt-2 md:mt-1"},lt={class:"w-auto flex flex-col md:flex-row"},nt=e("div",{class:"mr-2 font-bold tracking-tight"}," Effectivity: ",-1),it={class:"tracking-tight"},dt=e("th",{class:"p-3 max-w-xs"},"Area",-1),ut=e("th",{class:"p-3 max-w-xs"},"Minimum Requirement",-1),ct=e("th",{class:"p-3 w-16"},"Actual Situation",-1),rt=e("th",{class:"p-3 w-16"},"Evidence",-1),pt=e("th",{class:"p-3 whitespace-normal"},"Self-Evaluation Status",-1),ht=e("th",{class:"p-3 text-right"},[e("i",{class:"fas fa-ellipsis-v"})],-1),ft={class:"p-3 whitespace-normal max-w-10"},vt={class:"flex flex-col"},_t={class:"font-bold"},mt={class:"p-3 whitespace-normal max-w-xs"},gt={class:"flex flex-col text-justify"},bt={class:"h-32 max-w-lg p-3 relative group"},xt=["onUpdate:modelValue","name","id","disabled","onInput"],yt=["onClick"],wt=e("i",{class:"fas fa-pen"},null,-1),kt=[wt],St=["onUpdate:modelValue","name","id","onFocus","onInput"],Et={class:"h-auto p-3 w-16 flex flex-col justify-center"},Ct=["href"],Lt={key:0},Ft={key:1},It=["onClick","disabled","data-tooltip"],Nt=e("i",{class:"fas fa-trash"},null,-1),$t=[Nt],Mt={class:"h-32 p-3"},Vt={class:"w-full h-full"},Ut=["onUpdate:modelValue","id","name","onChange"],Bt=e("option",{value:"Complied"},"Complied",-1),At=e("option",{value:"Not complied"},"Not complied",-1),Dt=e("option",{value:"Not applicable"},"Not applicable",-1),Ht=[Bt,At,Dt],Rt={class:"p-3"},jt=["onClick","disabled"],zt=e("i",{class:"fas fa-upload mr-2"},null,-1),Ot=["onClick","disabled"],Tt=e("i",{class:"fas fa-upload mr-2"},null,-1),Kt={class:"text-center"},Pt=["disabled"],qt={key:0},Yt=e("i",{class:"fas fa-spinner animate-spin"},null,-1),Wt=[Yt],Gt={key:1},Jt=["disabled"],Qt={key:0},Xt=e("i",{class:"fas fa-spinner animate-spin"},null,-1),Zt=[Xt],es={key:1},ts={layout:ke,data(){return{itemsLayout:"list"}},methods:{listLayout(){this.itemsLayout="list"},gridLayout(){this.itemsLayout="grid"}}},is=Object.assign(ts,{__name:"HEI-Evaluation-Edit",props:["evaluation","items","progress","canSubmit"],setup(h){const S=h,O=t=>{i.value&&(t.returnValue=!0)};me(()=>{window.addEventListener("keydown",ee),window.addEventListener("beforeunload",O)}),ge(()=>{window.removeEventListener("keydown",ee),window.removeEventListener("beforeunload",O)});const N=o(!1),L=o(!1),T=o(null),$=o(!1),F=o(!1),K=o(null),I=o(null),se=o(!1),M=o(!1),P=o(null),V=o(null),q=o([]),U=o(!1),Y=o(""),W=o([]),B=o(!1),A=o([]),G=o([]),J=o([]),Q=o([]),i=o(!1),D=o([]),X=o(null),H=o(!1),w={actualSituationInput:A,selfEvaluationStatus:G,actionButtons:J,evidenceFiles:Q,saveBtn:X,texteditor:W,inputEvidenceFile:q};function oe(t,l){let r=A.value[t];r.style.height="128px";let b=r.scrollHeight+"px",f=384;r.style.height=Math.min(f,Math.max(128,parseInt(b)))+"px",i.value=!0,R(l)}function Z(t,l){let r=w.texteditor.value[t];r.style.height="250px";let b=r.scrollHeight+"px",f=400;r.style.height=Math.min(f,Math.max(128,parseInt(b)))+"px",i.value=!0,R(l)}function ae(t,l){let r=w.selfEvaluationStatus.value[t],b=w.actualSituationInput.value[t],f=w.actionButtons.value[t],k=w.evidenceFiles.value[t];i.value=!0,R(l),r.value=="Not applicable"?(b.disabled=!0,f.classList.contains("hidden")||f.classList.add("hidden"),k.classList.contains("hidden")||k.classList.add("hidden")):(b.disabled=!1,f.classList.contains("hidden")&&f.classList.remove("hidden"),k.classList.contains("hidden")&&k.classList.remove("hidden"))}function R(t){D.value.includes(t)||D.value.push(t)}function le(t){U.value=!0,Y.value=t}function ne(){U.value=!1}function ie(){B.value=!1}const ee=t=>{(t.ctrlKey||t.metaKey)&&(t.key==="s"||t.key==="S")&&(t.preventDefault(),w.saveBtn.value.click())};be({itemId:null,file:null});function de(){C.post("/hei/evaluation/update",{id:S.evaluation.id,items:S.items,rows:D.value},{onStart:()=>{H.value=!0},onFinish:()=>{H.value=!1},preserveScroll:!0,preserveState:!1})}function ue(){C.post("/hei/evaluation/link",{id:K.value,link:I.value},{onStart:()=>{F.value=!0},onFinish:()=>{F.value=!1},preserveState:!1,preserveScroll:!0})}function ce(){C.post("/hei/evaluation/link/delete",{id:S.evaluation.id,item:T.value},{onStart:()=>{L.value=!0},onFinish:()=>{L.value=!1},preserveState:!1,preserveScroll:!0})}function re(){C.post("/hei/evaluation/submit",S.evaluation)}return xe(V,t=>{C.post("/hei/evaluation/upload",{id:S.evaluation.id,itemId:P.value,file:V.value},{onStart:()=>{M.value=!0},onFinish:()=>{M.value=!1},preserveState:!1,preserveScroll:!0})}),(t,l)=>{const r=v("Head"),b=v("page-title"),f=v("Link"),k=v("text-editor"),pe=v("content-table"),he=v("content-container"),fe=v("confirmation"),ve=v("modal"),_e=v("confirmation-modal"),x=v("Notification");return d(),u(j,null,[n(r,{title:"Evaluation Form"}),n(b,{title:"Program Self-Evaluation"}),e("div",Se,[e("div",null,[n(f,{href:"/hei/evaluation"},{default:p(()=>[Ee]),_:1})]),e("div",Ce,[e("div",Le,[e("div",Fe,[m(" Complied"),Ie,e("span",Ne,_(h.progress.complied),1)]),e("div",$e,[m(" Not complied"),Me,e("span",Ve,_(h.progress.notComplied),1)]),e("div",Ue,[m(" Not applicable"),Be,e("span",Ae,_(h.progress.notApplicable),1)])]),e("div",De,[e("div",He,[m(" Progress"),Re,e("span",je,_(h.progress.percentage)+"%",1)])])]),e("div",ze,[e("div",Oe,[e("div",Te,[i.value?(d(),u("div",Ke," *Changes unsaved. ")):t.$page.props.flash.updated?(d(),u("div",Pe,[qe,m(" "+_(t.$page.props.flash.updated),1)])):(d(),u("div",Ye))])]),e("div",null,[g(e("button",{onClick:l[0]||(l[0]=s=>B.value=!0),class:"px-3 w-fit text-white bg-blue-500 hover:bg-blue-600 h-10 rounded mr-1"}," Ready for visit ",512),[[E,h.canSubmit&&!i.value]])]),e("button",{onClick:de,ref_key:"saveBtn",ref:X,class:y(["select-none cursor-pointer bg-blue-500 text-white px-2 w-fit h-10 rounded",{"text-gray-300 bg-gray-700":!i.value}]),disabled:!i.value},"Save Changes ",10,We)])]),n(he,null,{"main-content":p(()=>[e("div",Ge,[e("div",Je,[e("div",Qe,[Xe,e("div",Ze,_(h.evaluation.institution_program.institution.name),1)]),e("div",et,[e("div",tt,[st,e("div",ot,_(h.evaluation.institution_program.program.program),1)])]),e("div",at,[e("div",lt,[nt,e("div",it," A.Y. "+_(h.evaluation.effectivity),1)])])])]),g(n(pe,null,{"table-head":p(()=>[dt,ut,ct,rt,pt,ht]),"table-body":p(()=>[(d(!0),u(j,null,te(h.items,(s,c)=>(d(),u("tr",{key:s.id,class:y(["align-top text-base",{"bg-slate-200":c%2==0}])},[e("td",ft,[e("div",vt,[e("div",_t,_(s.area),1)])]),e("td",mt,[e("div",gt,_(s.minimumRequirement),1)]),e("td",bt,[g(e("textarea",{ref_for:!0,ref_key:"actualSituationInput",ref:A,"onUpdate:modelValue":a=>s.actualSituation=a,name:"actualSituation"+c,id:"actualSituation"+c,class:"w-full min-w-16 h-32 rounded border-2 border-gray-500 resize-none group custom-scrollbar",disabled:s.selfEvaluationStatus=="Not applicable",placeholder:"Input actual situation here",onInput:a=>oe(c,s.id)},`\r
                            `,40,xt),[[z,s.actualSituation]]),e("button",{onClick:a=>le(c),class:"absolute bottom-4 right-10 text-gray-500 hover:text-black group-focus-within:visible invisible tooltipForActions","data-tooltip":"Open editor"},kt,8,yt),n(k,{title:"Actual Situation",showModal:U.value&&Y.value==c,onClose:ne},{default:p(()=>[g(e("textarea",{ref_for:!0,ref_key:"texteditor",ref:W,"onUpdate:modelValue":a=>s.actualSituation=a,name:"actualSituationEditor"+c,id:"actualSituationEditor"+c,class:"w-full h-32 rounded border-2 border-gray-500 resize-none group",placeholder:"Input actual situation here",onFocus:a=>Z(c),onInput:a=>Z(c,s.id)},`\r
                            `,40,St),[[z,s.actualSituation]])]),_:2},1032,["showModal"])]),e("td",Et,[e("div",{class:y(["flex flex-col",{hidden:s.selfEvaluationStatus=="Not applicable"}]),ref_for:!0,ref_key:"evidenceFiles",ref:Q},[(d(!0),u(j,null,te(s.evidence,(a,ss)=>(d(),u("div",{key:a.id,class:"w-full"},[e("a",{class:"px-1 text-gray-600 hover:text-blue-500 m-1 rounded",href:a.url,target:"_blank"},[a.type=="file"?(d(),u("span",Lt," File ")):a.type=="link"?(d(),u("span",Ft," Link ")):ye("",!0)],8,Ct),e("button",{onClick:os=>{N.value=!0,T.value=a.id},class:y(["text-gray-500 hover:text-red-500 tooltipForActions",{"grayscale text-gray-500":i.value}]),disabled:s.selfEvaluationStatus=="Not applicable"||i.value,"data-tooltip":a.type=="file"?"Delete file":"Delete link"},$t,10,It)]))),128))],2)]),e("td",Mt,[e("div",Vt,[g(e("select",{ref_for:!0,ref_key:"selfEvaluationStatus",ref:G,"onUpdate:modelValue":a=>s.selfEvaluationStatus=a,id:"selfEvaluationStatus"+c,name:"selfEvaluationStatus"+c,onChange:a=>ae(c,s.id),class:"p-1 rounded w-36 border-2 border-gray-500 select-none"},Ht,40,Ut),[[we,s.selfEvaluationStatus]])])]),e("td",Rt,[e("div",{class:y(["w-full text-right text-sm visible",{invisible:s.selfEvaluationStatus=="Not applicable"}]),ref_for:!0,ref_key:"actionButtons",ref:J},[e("button",{onClick:a=>{se.value=!0,P.value=s.id,t.$refs.inputEvidenceFile.click()},class:y(["rounded bg-white h-8 mr-1 px-2 text-gray-700 hover:text-black active:text-blue-500 border-2 border-gray-500 tooltipForActions",{"grayscale text-gray-400":i.value}]),"data-tooltip":"Upload file",disabled:s.selfEvaluationStatus=="Not applicable"||i.value},[zt,m("File ")],10,jt),e("button",{onClick:a=>{$.value=!0,I.value=null,K.value=s.id},class:y(["rounded bg-white h-8 px-2 text-gray-700 hover:text-black active:text-blue-500 border-2 border-gray-500 tooltipForActions",{"grayscale text-gray-400":i.value}]),"data-tooltip":"Drop link",disabled:s.selfEvaluationStatus=="Not applicable"||i.value},[Tt,m("Link ")],10,Ot)],2)])],2))),128))]),_:1},512),[[E,t.itemsLayout==="list"]])]),_:1}),g(n(fe,{onClose:ie,title:"Ready For Visit"},{message:p(()=>[m(" Are you sure you want to submit this compliance tool? You won't be able to make changes after submitting. ")]),buttons:p(()=>[e("button",{class:"text-gray-100 bg-blue-500 hover:text-white hover:bg-blue-600 p-2 px-3 rounded mr-1",onClick:re}," Submit ")]),_:1},512),[[E,B.value]]),e("div",null,[e("input",{type:"file",hidden:"",ref_key:"inputEvidenceFile",ref:q,id:"inputEvidenceFile",onChange:l[1]||(l[1]=s=>V.value=s.target.files[0])},null,544)]),n(ve,{showModal:$.value,title:"Evidence Link",onClose:l[3]||(l[3]=s=>$.value=!1)},{"custom-button":p(()=>[e("button",{onClick:ue,disabled:F.value,class:"text-white bg-blue-600 hover:bg-blue-700 w-24 py-2 px-3 rounded border"},[F.value?(d(),u("span",qt,Wt)):(d(),u("span",Gt,"Upload"))],8,Pt)]),default:p(()=>[e("div",Kt,[g(e("textarea",{class:"w-full h-32 resize-none",placeholder:"Input URL/Link here",id:"link","onUpdate:modelValue":l[2]||(l[2]=s=>I.value=s)},`\r
            `,512),[[z,I.value]])])]),_:1},8,["showModal"]),n(_e,{showModal:N.value,onClose:l[4]||(l[4]=s=>N.value=!1),title:"Delete file/link"},{message:p(()=>[m(" Are you sure you want to delete this evidence file/link? This action can't be undone. ")]),buttons:p(()=>[e("button",{onClick:ce,disabled:L.value,class:"select-none text-white h-10 w-20 rounded bg-red-500"},[L.value?(d(),u("span",Qt,Zt)):(d(),u("span",es,"Delete"))],8,Jt)]),_:1},8,["showModal"]),n(x,{message:t.$page.props.flash.success,type:"success"},null,8,["message"]),n(x,{message:t.$page.props.flash.updated,type:"success"},null,8,["message"]),n(x,{message:t.$page.props.flash.deleted,type:"success"},null,8,["message"]),n(x,{message:t.$page.props.flash.uploaded,type:"success"},null,8,["message"]),n(x,{message:t.$page.props.errors.link,type:"failed"},null,8,["message"]),g(n(x,{message:"Saving...",type:"processing"},null,512),[[E,H.value]]),g(n(x,{message:"Uploading file...",type:"processing"},null,512),[[E,M.value]])],64)}}});export{is as default};
