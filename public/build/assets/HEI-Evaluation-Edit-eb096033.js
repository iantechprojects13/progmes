import{k as Se,l as Ee,m as s,E as Ce,s as Le,A as m,o as l,f as a,a as i,b as e,w as d,g as Y,t as _,d as x,i as h,p as L,F as q,B as F,C as re,n as S,D as Fe,O as E}from"./app-251762d9.js";import"./index-34e2e716.js";import Me from"./Layout-a6df9f1a.js";const Ie={class:"md:mx-8 mx-3 mt-8 flex flex-row justify-between rounded relative"},$e=e("button",{class:"select-none w-24 h-10 border border-gray-500 rounded bg-white hover:bg-gray-700 hover:text-white"},[e("i",{class:"fas fa-arrow-left mr-2"}),x(" Back ")],-1),Ne={class:"flex flex-col xl:flex-row items-center justify-between w-auto rounded border border-gray-400 bg-white mx-3 md:mx-8 mt-5 p-3"},Ue={class:"w-full text-left"},Ve={class:"w-auto flex flex-row items-center"},Be=e("i",{class:"fas fa-institution mr-3 text-blue-500"},null,-1),Ae={class:"w-auto flex flex-row items-center"},De=e("i",{class:"fas fa-book mr-3 text-blue-500"},null,-1),Te=e("span",null,null,-1),Re={class:"w-auto flex flex-row items-center"},He=e("i",{class:"fas fa-calendar-check mr-3 text-blue-500"},null,-1),je={class:"xl:w-auto w-full text-right mt-5 xl:mt-0"},Oe={class:"flex flex-col md:flex-row lg:mt-0 md:w-auto w-full"},ze={class:"flex-col xl:mt-0 mt-2 text-center mx-1 p-2 px-3 md:w-fit w-full rounded border border-gray-500 bg-white"},Ke={class:"w-full font-bold"},Pe=e("div",{class:"font-bold text-blue-500 whitespace-nowrap text-sm"},"Complied",-1),Ye={class:"flex-col xl:mt-0 mt-2 text-center mx-1 p-2 px-3 md:w-fit w-full rounded border border-gray-500 bg-white"},qe={class:"w-full font-bold"},We=e("div",{class:"font-bold text-blue-500 whitespace-nowrap text-sm"},"Not Complied",-1),Ge={class:"flex-col xl:mt-0 mt-2 text-center mx-1 p-2 px-3 md:w-fit w-full rounded border border-gray-500 bg-white"},Je={class:"w-full font-bold"},Qe=e("div",{class:"font-bold text-blue-500 whitespace-nowrap text-sm"},"Not Applicable",-1),Xe={class:"flex-col xl:mt-0 mt-2 text-center mx-1 p-2 px-3 md:w-fit w-full rounded border border-gray-500 bg-white"},Ze={class:"w-full font-bold"},et=e("div",{class:"font-bold text-blue-500 whitespace-nowrap text-sm"},"Progress",-1),tt={class:"whitespace-normal mr-2"},ot={key:0},st=e("i",{class:"fas fa-spinner animate-spin"},null,-1),lt=[st],at={key:1},nt={class:"mt-3 flex items-center lg:flex-row flex-col px-3 py-3"},it=e("label",{for:"conforme",class:"font-bold whitespace-nowrap w-full lg:mr-3 lg:w-32 text-start lg:text-right"},"Conforme",-1),ut={class:"whitespace-normal mr-2"},dt={class:"whitespace-normal"},rt={key:0,class:"text-red-500"},ct={key:1},pt=e("i",{class:"fas fa-check-circle text-green-500 mr-1"},null,-1),ft=e("th",{class:"p-3 max-w-xs"},"Area",-1),ht=e("th",{class:"p-3 max-w-xs"},"Minimum Requirement",-1),vt=e("th",{class:"p-3 w-16"},"Actual Situation",-1),mt=e("th",{class:"p-3 w-16"},"Evidence",-1),_t=e("th",{class:"p-3 whitespace-normal"},"Self-Evaluation Status",-1),bt=e("th",{class:"p-3 text-right"},[e("i",{class:"fas fa-ellipsis-v"})],-1),gt={class:"p-3 whitespace-normal max-w-10"},wt={class:"flex flex-col"},xt={class:"font-bold"},yt={class:"p-3 whitespace-normal max-w-xs"},kt={class:"flex flex-col text-justify"},St={class:"h-32 max-w-lg p-3 relative group"},Et=["onUpdate:modelValue","name","id","disabled","onInput"],Ct=["onClick"],Lt=e("i",{class:"fas fa-pen"},null,-1),Ft=[Lt],Mt=["onUpdate:modelValue","name","id","onFocus","onInput"],It={class:"h-auto p-3 w-16 flex flex-col justify-center"},$t=["href"],Nt={key:0},Ut={key:1},Vt=["onClick","disabled","data-tooltip"],Bt=e("i",{class:"fas fa-trash"},null,-1),At=[Bt],Dt={class:"h-32 p-3"},Tt={class:"w-full h-full"},Rt=["onUpdate:modelValue","id","name","onChange"],Ht=e("option",{value:null},"Select status",-1),jt=e("option",{value:"Complied"},"Complied",-1),Ot=e("option",{value:"Not complied"},"Not complied",-1),zt=e("option",{value:"Not applicable"},"Not applicable",-1),Kt=[Ht,jt,Ot,zt],Pt={class:"p-3"},Yt=["onClick","disabled"],qt=e("i",{class:"fas fa-upload mr-2"},null,-1),Wt=["onClick","disabled"],Gt=e("i",{class:"fas fa-upload mr-2"},null,-1),Jt={key:0},Qt=e("i",{class:"fas fa-spinner animate-spin"},null,-1),Xt=[Qt],Zt={key:1},eo={key:0},to=e("i",{class:"fas fa-spinner animate-spin"},null,-1),oo=[to],so={key:1},lo={class:"text-center"},ao=["disabled"],no={key:0},io=e("i",{class:"fas fa-spinner animate-spin"},null,-1),uo=[io],ro={key:1},co=["disabled"],po={key:0},fo=e("i",{class:"fas fa-spinner animate-spin"},null,-1),ho=[fo],vo={key:1},mo={layout:Me,data(){return{itemsLayout:"list"}},methods:{listLayout(){this.itemsLayout="list"},gridLayout(){this.itemsLayout="grid"}}},xo=Object.assign(mo,{__name:"HEI-Evaluation-Edit",props:["evaluation","items","progress"],setup(r){const b=r,W=t=>{c.value&&(t.returnValue=!0)};Se(()=>{window.addEventListener("keydown",ie),window.addEventListener("beforeunload",W)}),Ee(()=>{window.removeEventListener("keydown",ie),window.removeEventListener("beforeunload",W)});const U=s(!1),M=s(!1),G=s(null),V=s(!1),I=s(!1),J=s(null),$=s(null),ce=s(!1),B=s(!1),Q=s(null),A=s(null),X=s([]),D=s(!1),Z=s(""),ee=s([]),T=s(!1),R=s(!1),H=s([]),te=s([]),oe=s([]),se=s([]),c=s(!1),j=s([]),O=s(null),z=s(!1),N=s(!1),K=s(!1),k={actualSituationInput:H,selfEvaluationStatus:te,actionButtons:oe,evidenceFiles:se,saveBtn:O,texteditor:ee,inputEvidenceFile:X};function pe(t,u){let f=H.value[t];f.style.height="128px";let g=f.scrollHeight+"px",v=384;f.style.height=Math.min(v,Math.max(128,parseInt(g)))+"px",c.value=!0,P(u)}function le(t,u){let f=k.texteditor.value[t];f.style.height="250px";let g=f.scrollHeight+"px",v=400;f.style.height=Math.min(v,Math.max(128,parseInt(g)))+"px",c.value=!0,P(u)}function fe(t,u){let f=k.selfEvaluationStatus.value[t],g=k.actualSituationInput.value[t],v=k.actionButtons.value[t],y=k.evidenceFiles.value[t];c.value=!0,P(u),f.value=="Not applicable"?(g.disabled=!0,v.classList.contains("hidden")||v.classList.add("hidden"),y.classList.contains("hidden")||y.classList.add("hidden")):(g.disabled=!1,v.classList.contains("hidden")&&v.classList.remove("hidden"),y.classList.contains("hidden")&&y.classList.remove("hidden"))}function P(t){j.value.includes(t)||j.value.push(t)}function he(t){D.value=!0,Z.value=t}function ve(){D.value=!1}function ae(){T.value=!T.value}function ne(){R.value=!R.value}const ie=t=>{(t.ctrlKey||t.metaKey)&&(t.key==="s"||t.key==="S")&&(t.preventDefault(),k.saveBtn.value.click())},C=Ce({id:s(b.evaluation.id),name:s(b.evaluation.conforme),title:s(b.evaluation.conformeTitle)});function me(){E.post("/hei/evaluation/conforme",C,{onStart:()=>{K.value=!0},onFinish:()=>{K.value=!1},preserveScroll:!0,preserveState:!1})}function _e(){E.post("/hei/evaluation/update",{id:b.evaluation.id,items:b.items,rows:j.value},{onStart:()=>{z.value=!0},onFinish:()=>{z.value=!1},preserveScroll:!0,preserveState:!1})}function be(){E.post("/hei/evaluation/link",{id:J.value,link:$.value},{onStart:()=>{I.value=!0},onFinish:()=>{I.value=!1},preserveState:!1,preserveScroll:!0})}function ge(){E.post("/hei/evaluation/link/delete",{id:b.evaluation.id,item:G.value},{onStart:()=>{M.value=!0},onFinish:()=>{M.value=!1},preserveState:!1,preserveScroll:!0})}function ue(){E.post("/hei/evaluation/submit",b.evaluation,{onStart:()=>{N.value=!0},onFinish:()=>{N.value=!1},preserveState:!1,preserveScroll:!0})}return Le(A,t=>{E.post("/hei/evaluation/upload",{id:b.evaluation.id,itemId:Q.value,file:A.value},{onStart:()=>{B.value=!0},onFinish:()=>{B.value=!1},preserveState:!1,preserveScroll:!0})}),(t,u)=>{const f=m("Head"),g=m("page-title"),v=m("Link"),y=m("content-container"),we=m("text-editor"),xe=m("content-table"),de=m("confirmation"),ye=m("modal"),ke=m("confirmation-modal"),w=m("Notification");return l(),a(q,null,[i(f,{title:"Program Self-Evaluation Tool"}),i(g,{title:"Program Self-Evaluation"}),e("div",Ie,[e("div",null,[i(v,{href:"/evaluation"},{default:d(()=>[$e]),_:1})]),e("div",null,[r.progress[3]==100&&r.evaluation.evaluationDate!=null?(l(),a("button",{key:0,onClick:ne,class:"select-none px-3 w-fit text-white bg-blue-500 hover:bg-blue-600 h-10 rounded mr-1"}," Resubmit ")):r.progress[3]==100&&r.evaluation.evaluationDate==null?(l(),a("button",{key:1,onClick:ae,class:"select-none px-3 w-fit text-white bg-gray-700 hover:bg-gray-800 h-10 rounded mr-1"}," Ready for visit ")):Y("",!0)])]),e("div",Ne,[e("div",Ue,[e("div",Ve,[Be,e("div",null,_(r.evaluation.institution_program.institution.name),1)]),e("div",Ae,[De,e("div",null,[x(_(r.evaluation.institution_program.program.program)+" ",1),Te])]),e("div",Re,[He,e("div",null,"A.Y. "+_(r.evaluation.effectivity),1)])]),e("div",je,[e("div",Oe,[e("div",ze,[e("div",Ke,_(r.progress[0]),1),Pe]),e("div",Ye,[e("div",qe,_(r.progress[1]),1),We]),e("div",Ge,[e("div",Je,_(r.progress[2]),1),Qe]),e("div",Xe,[e("div",Ze,_(r.progress[3])+"%",1),et])])])]),i(y,{hasTopButton:!0},{"top-button":d(()=>[e("div",tt,[e("button",{onClick:me,ref_key:"saveBtn",ref:O,class:"select-none cursor-pointer bg-blue-500 hover:bg-blue-600 mr-2 text-white w-20 h-10 rounded"},[K.value?(l(),a("span",ot,lt)):(l(),a("span",at,"Save"))],512)])]),"main-content":d(()=>[e("div",nt,[it,h(e("input",{maxlength:"255",type:"text",id:"conforme",class:"w-full lg:w-1/2 rounded lg:mr-2 lg:mb-0 mb-1",placeholder:"Conforme","onUpdate:modelValue":u[0]||(u[0]=o=>C.name=o)},null,512),[[F,C.name]]),h(e("input",{maxlength:"255",type:"text",id:"conformeTitle",class:"w-full lg:w-1/2 rounded",placeholder:"Title","onUpdate:modelValue":u[1]||(u[1]=o=>C.title=o)},null,512),[[F,C.title]])])]),_:1}),i(y,{hasTopButton:!0},{"top-button":d(()=>[e("div",ut,[e("button",{onClick:_e,ref_key:"saveBtn",ref:O,class:"select-none cursor-pointer bg-blue-500 hover:bg-blue-600 mr-2 text-white px-2 w-fit h-10 rounded"},"Save Changes ",512)]),e("div",dt,[c.value?(l(),a("div",rt," *Changes unsaved. ")):t.$page.props.flash.updated?(l(),a("div",ct,[pt,x(" "+_(t.$page.props.flash.updated),1)])):Y("",!0)])]),"main-content":d(()=>[h(i(xe,null,{"table-head":d(()=>[ft,ht,vt,mt,_t,bt]),"table-body":d(()=>[(l(!0),a(q,null,re(r.items,(o,p)=>(l(),a("tr",{key:o.id,class:S(["align-top text-base",{"bg-slate-200":p%2==0}])},[e("td",gt,[e("div",wt,[e("div",xt,_(o.area),1)])]),e("td",yt,[e("div",kt,_(o.minimumRequirement),1)]),e("td",St,[h(e("textarea",{maxlength:"5000",ref_for:!0,ref_key:"actualSituationInput",ref:H,"onUpdate:modelValue":n=>o.actualSituation=n,name:"actualSituation"+p,id:"actualSituation"+p,class:"w-full min-w-16 h-32 rounded border-2 border-gray-500 resize-none group custom-scrollbar",disabled:o.selfEvaluationStatus=="Not applicable",placeholder:"Input actual situation here",onInput:n=>pe(p,o.id)},`\r
                            `,40,Et),[[F,o.actualSituation]]),e("button",{onClick:n=>he(p),class:"absolute bottom-4 right-10 text-gray-500 hover:text-black group-focus-within:visible invisible tooltipForActions","data-tooltip":"Open editor"},Ft,8,Ct),i(we,{title:"Actual Situation",showModal:D.value&&Z.value==p,onClose:ve},{default:d(()=>[h(e("textarea",{maxlength:"5000",ref_for:!0,ref_key:"texteditor",ref:ee,"onUpdate:modelValue":n=>o.actualSituation=n,name:"actualSituationEditor"+p,id:"actualSituationEditor"+p,class:"w-full h-32 rounded border-2 border-gray-500 resize-none group",placeholder:"Input actual situation here",onFocus:n=>le(p),onInput:n=>le(p,o.id)},`\r
                            `,40,Mt),[[F,o.actualSituation]])]),_:2},1032,["showModal"])]),e("td",It,[e("div",{class:S(["flex flex-col",{hidden:o.selfEvaluationStatus=="Not applicable"}]),ref_for:!0,ref_key:"evidenceFiles",ref:se},[(l(!0),a(q,null,re(o.evidence,n=>(l(),a("div",{key:n.id,class:"w-full"},[e("a",{class:"px-1 text-gray-600 hover:text-blue-500 m-1 rounded",href:n.url,target:"_blank"},[n.type=="file"?(l(),a("span",Nt," File ")):n.type=="link"?(l(),a("span",Ut," Link ")):Y("",!0)],8,$t),e("button",{onClick:_o=>{U.value=!0,G.value=n.id},class:S(["text-gray-500 hover:text-red-500 tooltipForActions",{"grayscale text-gray-500":c.value}]),disabled:o.selfEvaluationStatus=="Not applicable"||c.value,"data-tooltip":n.type=="file"?"Delete file":"Delete link"},At,10,Vt)]))),128))],2)]),e("td",Dt,[e("div",Tt,[h(e("select",{ref_for:!0,ref_key:"selfEvaluationStatus",ref:te,"onUpdate:modelValue":n=>o.selfEvaluationStatus=n,id:"selfEvaluationStatus"+p,name:"selfEvaluationStatus"+p,onChange:n=>fe(p,o.id),class:"p-1 rounded w-36 border-2 border-gray-500 select-none"},Kt,40,Rt),[[Fe,o.selfEvaluationStatus]])])]),e("td",Pt,[e("div",{class:S(["w-full text-right text-sm visible",{invisible:o.selfEvaluationStatus=="Not applicable"}]),ref_for:!0,ref_key:"actionButtons",ref:oe},[e("button",{onClick:n=>{ce.value=!0,Q.value=o.id,t.$refs.inputEvidenceFile.click()},class:S(["rounded bg-white h-8 mr-1 px-2 border-2 tooltipForActions",[{"grayscale text-blue-400 border-gray-400":c.value},{"hover:text-blue-500 border-gray-500":!c.value}]]),"data-tooltip":"Upload file",disabled:o.selfEvaluationStatus=="Not applicable"||c.value},[qt,x("File ")],10,Yt),e("button",{onClick:n=>{V.value=!0,$.value=null,J.value=o.id},class:S(["rounded bg-white h-8 px-2 border-2 tooltipForActions",[{"grayscale text-blue-400 border-gray-400":c.value},{"hover:text-blue-500 border-gray-500":!c.value}]]),"data-tooltip":"Drop link",disabled:o.selfEvaluationStatus=="Not applicable"||c.value},[Gt,x("Link ")],10,Wt)],2)])],2))),128))]),_:1},512),[[L,t.itemsLayout==="list"]])]),_:1}),h(i(de,{onClose:ae,title:"Ready For Visit"},{message:d(()=>[x(" Are you sure you want to submit this compliance evaluation tool? You won't be able to make changes after submitting. ")]),buttons:d(()=>[e("button",{class:"text-gray-100 bg-blue-500 hover:text-white hover:bg-blue-600 w-20 h-10 rounded mr-1",onClick:ue},[N.value?(l(),a("span",Jt,Xt)):(l(),a("span",Zt,"Submit"))])]),_:1},512),[[L,T.value]]),h(i(de,{onClose:ne,title:"Resubmit"},{message:d(()=>[x(" Are you sure you want to resubmit this compliance evaluation tool? You won't be able to make changes after resubmitting. ")]),buttons:d(()=>[e("button",{class:"text-gray-100 bg-blue-500 hover:text-white hover:bg-blue-600 w-20 h-10 rounded mr-1",onClick:ue},[N.value?(l(),a("span",eo,oo)):(l(),a("span",so,"Submit"))])]),_:1},512),[[L,R.value]]),e("div",null,[e("input",{type:"file",hidden:"",ref_key:"inputEvidenceFile",ref:X,id:"inputEvidenceFile",onChange:u[2]||(u[2]=o=>A.value=o.target.files[0])},null,544)]),i(ye,{showModal:V.value,title:"Evidence Link",onClose:u[4]||(u[4]=o=>V.value=!1)},{"custom-button":d(()=>[e("button",{onClick:be,disabled:I.value,class:"text-white bg-blue-600 hover:bg-blue-700 w-24 py-2 px-3 rounded border"},[I.value?(l(),a("span",no,uo)):(l(),a("span",ro,"Upload"))],8,ao)]),default:d(()=>[e("div",lo,[h(e("textarea",{maxlength:"1000",class:"w-full h-32 resize-none",placeholder:"Input URL/Link here",id:"link","onUpdate:modelValue":u[3]||(u[3]=o=>$.value=o)},`\r
            `,512),[[F,$.value]])])]),_:1},8,["showModal"]),i(ke,{showModal:U.value,onClose:u[5]||(u[5]=o=>U.value=!1),title:"Delete file/link"},{message:d(()=>[x(" Are you sure you want to delete this evidence file/link? This action can't be undone. ")]),buttons:d(()=>[e("button",{onClick:ge,disabled:M.value,class:"select-none text-white h-10 w-20 rounded bg-red-500"},[M.value?(l(),a("span",po,ho)):(l(),a("span",vo,"Delete"))],8,co)]),_:1},8,["showModal"]),i(w,{message:t.$page.props.flash.success,type:"success"},null,8,["message"]),i(w,{message:t.$page.props.flash.failed,type:"failed"},null,8,["message"]),i(w,{message:t.$page.props.flash.updated,type:"success"},null,8,["message"]),i(w,{message:t.$page.props.flash.deleted,type:"success"},null,8,["message"]),i(w,{message:t.$page.props.flash.uploaded,type:"success"},null,8,["message"]),i(w,{message:t.$page.props.errors.link,type:"failed"},null,8,["message"]),h(i(w,{message:"Saving...",type:"processing"},null,512),[[L,z.value]]),h(i(w,{message:"Uploading file...",type:"processing"},null,512),[[L,B.value]])],64)}}});export{xo as default};
